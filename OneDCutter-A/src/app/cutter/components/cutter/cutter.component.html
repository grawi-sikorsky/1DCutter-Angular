<div class="container">
  <div class="row">
    <div class=col-sm-3 id="addRowsHere" *ngIf="(cuts$ | async) as asyncCuts">


<!--
      <div class="accordion" id="accordionPanelsStayOpenExample">
        <div class="accordion-item">
          <h2 class="accordion-header" id="panelsStayOpen-headingOne">
            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="true" aria-controls="panelsStayOpen-collapseOne">
              Surowiec
            </button>
          </h2>
          <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-headingOne">
            <div class="accordion-body">

            </div>
          </div>
        </div>
        <div class="accordion-item">
          <h2 class="accordion-header" id="panelsStayOpen-headingTwo">
            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseTwo" aria-expanded="true" aria-controls="panelsStayOpen-collapseTwo">
              Formatki do cięcia
            </button>
          </h2>
          <div id="panelsStayOpen-collapseTwo" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-headingTwo">
            <div class="accordion-body">

            </div>
          </div>
        </div>
        <div class="accordion-item">
          <h2 class="accordion-header" id="panelsStayOpen-headingThree">
            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseThree" aria-expanded="true" aria-controls="panelsStayOpen-collapseThree">
              Ustawienia
            </button>
          </h2>
          <div id="panelsStayOpen-collapseThree" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-headingThree">
            <div class="accordion-body">
              Szerkość piły / rzaz / 
            </div>
          </div>
        </div>
      </div>
-->
              <!-- STOCK ------------------------------------------------------->
              <button type="button" id="add-stock-btn" class="btn btn-sm btn-primary"><i class="fas fa-plus"></i>
                Dodaj surowiec</button>

              <form id="leftform" control="" class="form-group" [formGroup]="cutform" (ngSubmit)="submitOrder()">
                

                <table id="stockTable" class="table table-striped table-hover">
                  <label>Surowiec </label>
                  <tr>
                    <th> Dlugość materiału </th>
                    <th> Ilość </th>
                    <th> </th>
                  </tr>

                  <tr th:id="'stock-table' + ${iterStat.index}" class="stock-table" *ngFor="let stock of asyncCuts.stockList; let index = index" >
                    <td>
                      <input class="form-control" type="number" [formControlName]="'in_stocklength' + index" [(ngModel)]="stock.stockLength" >
                      
                    </td>
                    <td>
                      <input class="form-control" type="number" [name]="'in_stockPcs' + index" [(ngModel)]="stock.stockPcs" >
                    </td>
                    <td>
                      <button type="button" class="btn btn-sm btn-danger" id="bt" value="Delete" onclick="removeRowStock(this)">Usuń</button>
                    </td>
                  </tr>
                </table>
                <div>
                  
                </div>
                <!-- STOCK ------------------------------------------------------->

              <!-- CUTSSSSS ------------------------------------------------------->
                <button type="button" id="add-btn" class="btn btn-sm btn-primary"><i class="fas fa-plus"></i> Dodaj
                  formatkę</button>
                <table id="cutTable" class="table">
                  <label>Formatki </label>
                  <tr>
                    <th> Dlugość odcinka </th>
                    <th> Ilość </th>
                    <th> </th>
                  </tr>

                  <tr th:id="'unit-table' + ${iterStat.index}" class="unit-table" *ngFor="let cut of asyncCuts.cutList; let index = index" >
                    <td>
                      <input class="form-control" type="number" [name]="'in_cutlength' + index" [(ngModel)]="cut.cutLength" (ngModelChange)="change(cut.cutLength)" >
                    </td>
                    <td>
                      <input class="form-control" type="number" [name]="'in_cutPcs' + index" [(ngModel)]="cut.cutPcs" (ngModelChange)="change(cut.cutPcs)" >
                    </td>
                    <td>
                      <button type="button" class="btn btn-sm btn-danger" id="bt" value="Delete" onclick="removeRowCuts(this)">Usuń</button>
                    </td>
                  </tr>
                </table>
                <button id="opti" class="btn btn-lg btn-primary btn-block" type="submit"><i class="fas fa-check"></i> Optymalizuj
                </button>
                </form>
                <!-- CUTSSSSS ------------------------------------------------------->
                <div *ngFor="let cut of asyncCuts.cutList">
                  {{cut.cutLength}} : {{cut.cutPcs}}
                </div>

                <div *ngFor="let stock of asyncCuts.stockList">
                  {{stock.stockLength}} : {{stock.stockPcs}}
                </div>
    </div>


    <!-- PRAWAAAA -->
    
    <div class="col-sm-8">
      <div class="wynikicol" *ngIf="(results$ | async) as asyncResult">
        <div class="col-sm">
          <label> Dostepna dlugosc pretow: </label><span th:text=" ${stockLen}"></span>
        </div>
        <div class="col-sm">
          <label> Dostepna ilosc pretow: </label><span th:text=" ${stockPcs}"></span>
        </div>
        <div class="col-sm">
          <label> Ilosc potrzebnego materialu: </label><span> {{asyncResult.resultUsed | number }}</span>
        </div>
        <div class="col-sm">
          <label> Procent odpadu: </label><span> {{asyncResult.resultWasteProcent | number: '1.2-2' }} %</span>
        </div>
        <div class="progress probar">
          <div class="progress-bar bg-success cutbar" role="progressbar" [ngStyle]="{'width': asyncResult.resultUsedProcent +'%'}" th:text=" 'Wykorzystano: ' + ${usedproc} + ' %' ">
            {{asyncResult.resultUsedProcent | number: '1.2-2' }} %
          </div>
          <div class="progress-bar bg-warning cutbar" role="progressbar" [ngStyle]="{'width': asyncResult.resultWasteProcent +'%'}" th:text=" 'Odpad: ' + ${wasteproc} + ' %' ">
            {{asyncResult.resultWasteProcent | number: '1.2-2' }} %
          </div>
        </div>
        <div class="col-sm">
          <label> Wymagane odcinki: </label><span> {{asyncResult.resultNeededStock }} </span>
        </div>
        <div class="col-sm">
        </div>
        <div class="col-sm">
          <label> ------------------------------------------------------- </label>
        </div>
        <div class="col-sm">
          <label> Wyniki: </label>
          <option th:each="instance : ${wyniki}" th:value="${instance}" th:text="${instance}" th:name="wyniki"></option>
        </div>

        <div class="progress probar" *ngFor="let stock of listStock">
          <div class="cutbar progress-bar bg-success" role="progressbar"  th:text="${bar.barText}">
            Free Space
          </div>
        </div>

        <div>
          <tr *ngFor="let stock of listStock">
            <td>
              {{stock.stockLenght}}: | 
            </td>
            <td>
              {{stock.cuts}}
            </td>
          </tr>

          <div >
            <div>
              <div class="progress probar" *ngFor="let bar of (asyncResult.resultBars)" >
                <div *ngFor="let barpcs of bar.resultBarPieces" class="cutbar progress-bar bg-success" [ngStyle]="{'width': barpcs.barWidthProc +'%'}" role="progressbar" >
                  {{barpcs.barText}}
                </div>
              </div>
            </div>
          </div>


        </div>
      </div>
    </div>
  </div>
</div>



<script>

  // delete TABLE row function.
  function removeRowCuts(oButton) {
    var empTab = document.getElementById('cutTable');
    empTab.deleteRow(oButton.parentNode.parentNode.rowIndex); // button -> td -> tr.
  }

  // delete TABLE row function.
  function removeRowStock(oButton) {
    var empTab = document.getElementById('stockTable');
    empTab.deleteRow(oButton.parentNode.parentNode.rowIndex); // button -> td -> tr.
  }


  jQuery(function ($) {
    var $button = $('#add-btn'),
      $row = $('.unit-table0').clone();

    $button.click(function () {
      $row.clone().insertBefore($('#unit-table0').attr("class", "dupa"));
    });
  });

  jQuery(function ($) {
    var $button = $('#add-stock-btn'),
      $row = $('.stock-table0').clone();

    $button.click(function () {
      $row.clone().insertBefore($('#stock-table0').attr("class", "dupa"));
    });
  });

</script>